<html lang="zh-TW"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è»Šéšªå…§å®¹è¼”åŠ©èªªæ˜</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin="" src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin="" src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap');
        body { font-family: 'Noto Sans TC', sans-serif; background-color: #f3f4f6; }
        .paper-shadow { box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06); }
        
        .font-jhenghei { 
            font-family: "Microsoft JhengHei", "å¾®è»Ÿæ­£é»‘é«”", sans-serif !important; 
        }

        @keyframes bounce-slow {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-3px); }
        }
        @keyframes pulse-soft {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }

        /* æ‰‹æ©Ÿæ¨¡å¼æ¨£å¼ */
        .mobile-print-mode { 
            width: 100% !important; 
            max-width: 100% !important; 
            margin: 0 !important; 
            padding: 0 !important;
            background: #f8fafc !important;
        }
        .mobile-print-mode .grid { display: block !important; }
        .mobile-print-mode .grid > div { 
            margin-bottom: 16px; 
            width: 94% !important; 
            margin-left: auto !important;
            margin-right: auto !important;
            border-radius: 12px !important;
            overflow: hidden !important;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05) !important;
        }

        .mobile-print-mode table { font-size: 11pt !important; line-height: 1.4 !important; width: 100% !important; }
        .mobile-print-mode th, .mobile-print-mode td { padding: 8px 6px !important; }
        .mobile-print-mode thead th {
            font-size: 13pt !important;
            font-weight: 900 !important;
            color: #1e40af !important;
            background: #eff6ff !important;
            padding-bottom: 10px !important;
            border-bottom: 2px solid #3b82f6 !important;
        }
        .mobile-print-mode td:first-child {
            font-size: 11pt !important;
            font-weight: 800 !important;
            text-align: center !important;
            width: auto !important;
            color: #1d4ed8 !important;
        }

        .mobile-print-mode h3 { 
            font-size: 15pt !important; 
            padding-bottom: 6px !important; 
            margin-bottom: 12px !important; 
            display: flex;
            align-items: center;
            color: #1e3a8a !important;
        }
        .mobile-print-mode h3::before { content: "ğŸ“‹ "; animation: bounce-slow 2s infinite; margin-right: 4px; }

        .mobile-print-mode h4 { 
            font-size: 13pt !important; 
            margin-top: 15px !important; 
            margin-bottom: 8px !important; 
        }
        .mobile-print-mode h4.caution { color: #b91c1c !important; }
        .mobile-print-mode h4.caution::before { content: "ğŸ’¡ "; }
        .mobile-print-mode h4.service-title { color: #2563eb !important; }
        .mobile-print-mode h4.service-title::before { content: "ğŸ› ï¸ "; animation: pulse-soft 2s infinite; margin-right: 4px; }

        /* é€£çµæŒ‰éˆ•ç¾åŒ– */
        .coverage-link { 
            display: inline-flex !important; 
            align-items: center !important;
            white-space: nowrap !important;
            font-size: 10pt !important; 
            background: linear-gradient(135deg, #ffffff 0%, #f0f7ff 100%) !important; 
            border: 1px solid #3b82f6 !important;
            padding: 3px 8px !important;
            border-radius: 20px !important;
            text-decoration: none !important;
            color: #2563eb !important; 
            box-shadow: 0 2px 4px rgba(59, 130, 246, 0.1) !important;
            transition: all 0.2s ease !important;
            margin-right: 4px !important;
            margin-bottom: 4px !important;
        }
        
        .link-wrapper {
            display: flex !important;
            flex-direction: row !important;
            flex-wrap: wrap !important;
            align-items: center !important;
            margin-top: 6px !important;
            width: 100% !important;
        }

        /* æ–‡å­—æ”¾å¤§æ•ˆæœ */
        .zoom-item {
            transition: transform 0.2s ease-in-out;
            display: block;
        }
        .zoom-item:hover {
            transform: scale(1.1);
            z-index: 10;
        }

        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }
        .accordion-content.open {
            max-height: 5000px;
        }

        @media print {
            .no-print { display: none !important; }
            @page { margin: 5mm; size: auto; }
            body { background-color: white; -webkit-print-color-adjust: exact; print-color-adjust: exact; margin: 0; padding: 0; }
            .paper-shadow { box-shadow: none; border: none; }
            .page-break { page-break-inside: avoid; }
            .bg-blue-700 { background-color: #1d4ed8 !important; -webkit-print-color-adjust: exact; }
            .text-white { color: white !important; }
            .accordion-content { max-height: none !important; overflow: visible !important; }
            .zoom-item:hover { transform: none !important; }
        }
    </style>

    <script id="saved-data" type="application/json">{
  "meta": {
    "quoteNumber": "",
    "salesName": "",
    "salesId": "",
    "date": ""
  },
  "client": {
    "name": "",
    "id": "",
    "dob": "",
    "phone": "",
    "address": "",
    "plate": "",
    "model": "",
    "manufacturingDate": "",
    "issueDate": "",
    "engineNo": "",
    "policyPeriod": ""
  },
  "coverages": [],
  "linkLibrary": [
    {
      "id": 1,
      "code": "07",
      "keyword": "è»Šé«”æå¤±ä¿éšªä¸™å¼-å…è‡ªè² é¡è»Šå°è»Šç¢°æ’æå¤±éšª",
      "link1": {
        "name": "ç”²ã€ä¹™ã€ä¸™å¼ç°¡ä»‹",
        "url": "https://youtu.be/OEOnzo6RjGw?si=f-pcTe3q8fzU-gAK"
      },
      "link2": {
        "name": "",
        "url": ""
      },
      "link3": {
        "name": "ç›®éŒ„",
        "url": "https://www.nanshangeneral.com.tw/product_personal-automobile-insurance_pd"
      },
      "link4": {
        "name": "æ¢æ¬¾",
        "url": "https://drive.google.com/file/d/1LGoLn71IfMd0ULbAU6q7nR572t_HiLAS/view?usp=drive_link"
      }
    },
    {
      "id": 2,
      "code": "96",
      "keyword": "è»Šé«”æå¤±ä¿éšª15%æŠ˜èˆŠç‡é™„åŠ æ¢æ¬¾",
      "link1": {
        "name": "",
        "url": ""
      },
      "link2": {
        "name": "",
        "url": ""
      },
      "link3": {
        "name": "ç›®éŒ„",
        "url": ""
      },
      "link4": {
        "name": "æ¢æ¬¾",
        "url": "https://drive.google.com/file/d/1RdJVI_whVwBRXUqDLdY1ivXJbmqEtD_C/view?usp=drive_link"
      }
    },
    {
      "id": 3,
      "code": "31",
      "keyword": "æ±½è»Šç¬¬ä¸‰äººè²¬ä»»ä¿éšª",
      "link1": {
        "name": "æ¡ˆä¾‹",
        "url": "https://youtu.be/WSTcpZntol8?si=Zy0vvr4ZylaIS3SN"
      },
      "link2": {
        "name": "",
        "url": ""
      },
      "link3": {
        "name": "ç›®éŒ„",
        "url": "https://www.nanshangeneral.com.tw/product_personal-automobile-insurance_liability"
      },
      "link4": {
        "name": "æ¢æ¬¾",
        "url": "https://drive.google.com/file/d/1b08o7bpVW2-VLlXx0oYBFpWKyWdQpo_D/view?usp=drive_link"
      }
    },
    {
      "id": 4,
      "code": "32",
      "keyword": "æ±½è»Šç¬¬ä¸‰äººè²¬ä»»ä¿éšª(è²¡æ)",
      "link1": {
        "name": "æ¡ˆä¾‹",
        "url": "https://youtu.be/2LRkVabyZUA?si=Say8G6-6gue2-idp"
      },
      "link2": {
        "name": "",
        "url": ""
      },
      "link3": {
        "name": "ç›®éŒ„",
        "url": "https://www.nanshangeneral.com.tw/product_personal-automobile-insurance_liability"
      },
      "link4": {
        "name": "æ¢æ¬¾",
        "url": "https://drive.google.com/file/d/1b08o7bpVW2-VLlXx0oYBFpWKyWdQpo_D/view?usp=drive_link"
      }
    },
    {
      "id": 5,
      "code": "9B",
      "keyword": "ç¬¬ä¸‰äººè²¬ä»»ä¿éšªæ…°å•é‡‘è²»ç”¨é™„åŠ æ¢æ¬¾",
      "link1": {
        "name": "",
        "url": ""
      },
      "link2": {
        "name": "",
        "url": ""
      },
      "link3": {
        "name": "ç›®éŒ„",
        "url": ""
      },
      "link4": {
        "name": "æ¢æ¬¾",
        "url": "https://drive.google.com/file/d/1o0vgdpriTF0x9Ynw_lhMrZmz14AXuVYk/view?usp=drive_link"
      }
    },
    {
      "id": 6,
      "code": "58",
      "keyword": "ç¬¬ä¸‰äººè²¬ä»»ä¿éšªé™„åŠ ä¹˜å®¢é«”å‚·å–®ä¸€ä¿é¡è²¬ä»»ä¿éšª",
      "link1": {
        "name": "",
        "url": ""
      },
      "link2": {
        "name": "",
        "url": ""
      },
      "link3": {
        "name": "ç›®éŒ„",
        "url": ""
      },
      "link4": {
        "name": "æ¢æ¬¾",
        "url": "https://drive.google.com/file/d/1Hzjkr3Tv54-twCmCC2iFayLaTJ-3zlRt/view?usp=drive_link"
      }
    },
    {
      "id": 7,
      "code": "9C",
      "keyword": "é™„åŠ ä¹˜å®¢é«”å‚·å–®ä¸€ä¿é¡è²¬ä»»ä¿éšªæ…°å•é‡‘è²»ç”¨",
      "link1": {
        "name": "",
        "url": ""
      },
      "link2": {
        "name": "",
        "url": ""
      },
      "link3": {
        "name": "ç›®éŒ„",
        "url": ""
      },
      "link4": {
        "name": "æ¢æ¬¾",
        "url": "https://drive.google.com/file/d/1kAJpdpv3-xc0NSM_ADyhXxdq9Hy3V8ld/view?usp=drive_link"
      }
    },
    {
      "id": 8,
      "code": "39",
      "keyword": "è¶…é¡è²¬ä»»é™„åŠ æ¢æ¬¾(ç¶“æ¿Ÿå‹)",
      "link1": {
        "name": "è¶…é¡è²¬ä»»éšªé‡è¦æ€§",
        "url": "https://youtu.be/SnPFWoBa8jI?si=gcX12pF3RkZi1ziE"
      },
      "link2": {
        "name": "",
        "url": ""
      },
      "link3": {
        "name": "ç›®éŒ„",
        "url": ""
      },
      "link4": {
        "name": "æ¢æ¬¾",
        "url": "https://drive.google.com/file/d/1ridqUVo5TiDGQccYjLXUBUL03dCpRw6F/view?usp=sharing"
      }
    },
    {
      "id": 9,
      "code": "91",
      "keyword": "ç¬¬ä¸‰äººè²¬ä»»ä¿éšªé™„åŠ åˆ‘äº‹è¨´è¨Ÿå¾‹å¸«è²»ç”¨è£œå„Ÿä¿éšª",
      "link1": {
        "name": "",
        "url": ""
      },
      "link2": {
        "name": "",
        "url": ""
      },
      "link3": {
        "name": "ç›®éŒ„",
        "url": ""
      },
      "link4": {
        "name": "æ¢æ¬¾",
        "url": "https://drive.google.com/file/d/1RXSzQ6WnjGn-SQgeKnE2WMwkrkxDe_qQ/view?usp=sharing"
      }
    },
    {
      "id": 10,
      "code": "93",
      "keyword": "æ±½è»Šä¿éšªé“è·¯æ•‘æ´è²»ç”¨é™„åŠ æ¢æ¬¾",
      "link1": {
        "name": "",
        "url": ""
      },
      "link2": {
        "name": "",
        "url": ""
      },
      "link3": {
        "name": "ç›®éŒ„",
        "url": ""
      },
      "link4": {
        "name": "æ¢æ¬¾",
        "url": "https://drive.google.com/file/d/1VG-eO8HaggAmfwLRXhOS-ifCRn5lqJFh/view?usp=drive_link"
      }
    },
    {
      "id": 11,
      "code": "85",
      "keyword": "äº¤é€šäº‹æ•…è½‰ä¹˜è²»ç”¨é™„åŠ æ¢æ¬¾",
      "link1": {
        "name": "",
        "url": ""
      },
      "link2": {
        "name": "",
        "url": ""
      },
      "link3": {
        "name": "ç›®éŒ„",
        "url": ""
      },
      "link4": {
        "name": "æ¢æ¬¾",
        "url": "https://drive.google.com/file/d/11DqsFzlaVsvRaJAMMyHZGZYWdHEB3yPS/view?usp=sharing"
      }
    },
    {
      "id": 12,
      "code": "11",
      "keyword": "ç«Šç›œæå¤±ä¿éšª",
      "link1": {
        "name": "æ¡ˆä¾‹",
        "url": "https://youtu.be/v5bhsVylm0c?si=0vXva6DE2pEzKwF5"
      },
      "link2": {
        "name": "",
        "url": ""
      },
      "link3": {
        "name": "ç›®éŒ„",
        "url": "https://www.nanshangeneral.com.tw/product_personal-automobile-insurance_thief"
      },
      "link4": {
        "name": "æ¢æ¬¾",
        "url": "https://drive.google.com/file/d/1RqMeId9DobdxutJQ2n0dNnJMOdtNBM_l/view?usp=sharing"
      }
    },
    {
      "id": 13,
      "code": "97",
      "keyword": " ç«Šç›œæå¤±ä¿éšª15%æŠ˜èˆŠç‡é™„åŠ æ¢æ¬¾",
      "link1": {
        "name": "",
        "url": ""
      },
      "link2": {
        "name": "",
        "url": ""
      },
      "link3": {
        "name": "ç›®éŒ„",
        "url": ""
      },
      "link4": {
        "name": "æ¢æ¬¾",
        "url": "https://drive.google.com/file/d/1aVeQ6974hcSTA4E0MKn3qABvXYhYxlc9/view?usp=sharing"
      }
    },
    {
      "id": 14,
      "code": "13",
      "keyword": "é›¶é…ä»¶è¢«ç«Šæå¤±é«˜é¡ä¿éšœé™„åŠ æ¢æ¬¾",
      "link1": {
        "name": "",
        "url": ""
      },
      "link2": {
        "name": "",
        "url": ""
      },
      "link3": {
        "name": "ç›®éŒ„",
        "url": ""
      },
      "link4": {
        "name": "æ¢æ¬¾",
        "url": "https://drive.google.com/file/d/1BLUX2NizgeJNfCUEgrxUaPtHHP7pI-0C/view?usp=drive_link"
      }
    },
    {
      "id": 15,
      "code": "14",
      "keyword": " ç«Šç›œæå¤±ä¿éšªä»£æ­¥è²»ç”¨é™„åŠ æ¢æ¬¾(ç’°å‹)",
      "link1": {
        "name": "",
        "url": ""
      },
      "link2": {
        "name": "",
        "url": ""
      },
      "link3": {
        "name": "ç›®éŒ„",
        "url": ""
      },
      "link4": {
        "name": "æ¢æ¬¾",
        "url": "https://drive.google.com/file/d/1eE1zEYse8MXLPEWdIITpsD1oyLrvICua/view?usp=drive_link"
      }
    },
    {
      "id": 16,
      "code": "H2",
      "keyword": "å¼·åˆ¶æ±½è»Šè²¬ä»»ä¿éšªé§•é§›äººå‚·å®³é™„åŠ æ¢æ¬¾(å–®ä¸€äº‹æ•…)",
      "link1": {
        "name": "æ¡ˆä¾‹",
        "url": "https://youtu.be/aK_GOLWwVj0?si=3Oc70qVM1Ou8P8Qu"
      },
      "link2": {
        "name": "",
        "url": ""
      },
      "link3": {
        "name": "ç›®éŒ„",
        "url": ""
      },
      "link4": {
        "name": "æ¢æ¬¾",
        "url": "https://drive.google.com/file/d/1pc7y7rjqiD1rinIfNfYZMHvjZonV2_ZE/view?usp=drive_link"
      }
    },
    {
      "id": 17,
      "code": "05",
      "keyword": "è»Šé«”æå¤±ä¿éšªä¹™å¼",
      "link1": {
        "name": "ç”²ã€ä¹™ã€ä¸™å¼ç°¡ä»‹",
        "url": "https://youtu.be/OEOnzo6RjGw?si=f-pcTe3q8fzU-gAK"
      },
      "link2": {
        "name": "",
        "url": ""
      },
      "link3": {
        "name": "ç›®éŒ„",
        "url": ""
      },
      "link4": {
        "name": "æ¢æ¬¾",
        "url": "https://drive.google.com/file/d/1nGQj2tr-OHHV7GRKETZFQLcNoqGZ6ypW/view?usp=sharing"
      }
    },
    {
      "id": 18,
      "code": "å¼·",
      "keyword": "å¼·åˆ¶æ±½è»Šè²¬ä»»ä¿éšª",
      "link1": {
        "name": "æ¡ˆä¾‹",
        "url": ""
      },
      "link2": {
        "name": "",
        "url": ""
      },
      "link3": {
        "name": "ç›®éŒ„",
        "url": "https://www.nanshangeneral.com.tw/product_personal-automobile-insurance_compulsory"
      },
      "link4": {
        "name": "æ¢æ¬¾",
        "url": "https://drive.google.com/file/d/16bUs8sr7P3c5GFeQif3Ct7AJMCXQ3S9K/view?usp=drive_link"
      }
    },
    {
      "id": 1768196072448,
      "code": "37",
      "keyword": "æ©Ÿè»Šè²¬ä»»ç¶œåˆä¿éšª",
      "link1": {
        "name": "",
        "url": ""
      },
      "link2": {
        "name": "",
        "url": ""
      },
      "link3": {
        "name": "ç›®éŒ„",
        "url": "https://drive.google.com/file/d/1Oz77Hcwkbce1Pdi8kL4oaLpiK5cHSEHB/view?usp=drive_link"
      },
      "link4": {
        "name": "æ¢æ¬¾",
        "url": "https://drive.google.com/file/d/17sH55SPyEvQSup5jd1heCzQ_KneBDpIA/view?usp=drive_link"
      }
    },
    {
      "id": 1768196251838,
      "code": "38",
      "keyword": "æ©Ÿè»Šè²¬ä»»ç¶œåˆä¿éšªè¶…é¡è²¬ä»»é™„åŠ æ¢æ¬¾",
      "link1": {
        "name": "è¶…é¡è²¬ä»»éšªé‡è¦æ€§",
        "url": "https://youtu.be/SnPFWoBa8jI?si=gcX12pF3RkZi1ziE"
      },
      "link2": {
        "name": "",
        "url": ""
      },
      "link3": {
        "name": "",
        "url": ""
      },
      "link4": {
        "name": "æ¢æ¬¾",
        "url": "https://drive.google.com/file/d/1Fb_J-6UaTxYfvIZkUdXPx-UeGqDbEghx/view?usp=drive_link"
      }
    },
    {
      "id": 1768196309694,
      "code": "S9",
      "keyword": "åˆ‘äº‹è¨´è¨Ÿå¾‹å¸«è²»ç”¨è£œå„Ÿä¿éšª",
      "link1": {
        "name": "åˆ‘äº‹å¾‹å¸«æ¡ˆä¾‹",
        "url": "https://youtu.be/WSTcpZntol8?si=0sOiT8LRWIebIi3p"
      },
      "link2": {
        "name": "",
        "url": ""
      },
      "link3": {
        "name": "",
        "url": ""
      },
      "link4": {
        "name": "æ¢æ¬¾",
        "url": "https://drive.google.com/file/d/1GgC8hVvPEvSEOU5gqjU8ukccJNNQYFRM/view?usp=drive_link"
      }
    },
    {
      "id": 1768196460257,
      "code": "47",
      "keyword": "å¼·åˆ¶æ±½è»Šè²¬ä»»ä¿éšªé§•é§›äººå‚·å®³é™„åŠ æ¢æ¬¾",
      "link1": {
        "name": "å‚·å®³éšªèªªæ˜",
        "url": "https://youtu.be/W-VpETJfv5I?si=UkUIdNkLGjoPUbRX"
      },
      "link2": {
        "name": "",
        "url": ""
      },
      "link3": {
        "name": "",
        "url": ""
      },
      "link4": {
        "name": "æ¢æ¬¾",
        "url": "https://drive.google.com/file/d/1d7FyDJoV4bRdKmPc7CQdh7COoiIS0Moc/view?usp=drive_link"
      }
    },
    {
      "id": 1768213582952,
      "code": "",
      "keyword": "è»Šéšªå ±åƒ¹å–®å…§å®¹",
      "link1": {
        "name": "è»Šéšªå ±åƒ¹å–®å…§å®¹",
        "url": ""
      },
      "link2": {
        "name": "",
        "url": ""
      },
      "link3": {
        "name": "",
        "url": ""
      },
      "link4": {
        "name": "",
        "url": ""
      }
    },
    {
      "id": 1768226654097,
      "code": "",
      "keyword": "ä¸Šç¶²ç¹³è²»",
      "link1": {
        "name": "ä¸Šç¶²ç¹³è²»",
        "url": ""
      },
      "link2": {
        "name": "",
        "url": ""
      },
      "link3": {
        "name": "",
        "url": ""
      },
      "link4": {
        "name": "",
        "url": ""
      }
    }
  ]
}</script>

    <script type="text/babel">
        const { useState, useRef, useEffect, useMemo, useCallback } = React;

        const getInitialData = () => {
            try {
                const dataScript = document.getElementById('saved-data');
                if (dataScript && dataScript.textContent) return JSON.parse(dataScript.textContent);
            } catch (e) { console.error("è®€å–åˆå§‹åŒ–è³‡æ–™å¤±æ•—:", e); }
            return { meta: {}, client: {}, coverages: [], linkLibrary: [] };
        };

        const INITIAL_DATA = getInitialData();
        const FACTORY_DEFAULTS = JSON.parse(JSON.stringify(INITIAL_DATA));

        const PromptModal = ({ onClose }) => {
            const promptText = `ä½ æ˜¯å°ˆæ¥­çš„è½‰å°åŠ©ç†ã€‚è«‹å”åŠ©æˆ‘å°‡ä»¥ä¸‹çš„ã€Œä¿éšªå ±åƒ¹å–®å…§å®¹ã€ï¼ˆæ–‡å­—æˆ–åœ–ç‰‡è¾¨è­˜çµæœï¼‰ï¼Œè½‰æ›ç‚ºç‰¹å®šçš„ JSON æ ¼å¼ã€‚\n\n**è½‰æ›è¦å‰‡èˆ‡è¦æ±‚ï¼š**\n1. **æ ¼å¼çµæ§‹**ï¼šå¿…é ˆåš´æ ¼éµå®ˆä¸‹æ–¹çš„ JSON çµæ§‹ç¯„æœ¬ã€‚\n2. **è³‡æ–™æå–**ï¼š\n   - \`meta\`: æå–å ±åƒ¹å–®è™Ÿ(quoteNumber)èˆ‡æ—¥æœŸ(date).\n   - \`client\`: æå–è¢«ä¿éšªäººå§“åã€èº«åˆ†è­‰å­—è™Ÿã€è»Šç‰Œã€è»Šå‹ã€å¼•æ“è™Ÿç¢¼ã€ä¿éšªæœŸé–“ç­‰è³‡è¨Šã€‚æ³¨æ„ï¼šã€Œå‡ºå» å¹´æœˆã€èˆ‡ã€Œç™¼ç…§æ—¥æœŸã€è«‹ä¸€å¾‹è¨­ç‚ºç©ºå­—ä¸² \"\"ã€‚\n   - \`coverages\`: éšªç¨®æ˜ç´°ã€‚\n     - \`code\`: éšªç¨®ä»£è™Ÿã€‚\n     - \`name\`: éšªç¨®åç¨±ã€‚\n     - \`detail\`: çµ¦ä»˜é …ç›®æˆ–å‚™è¨»ã€‚\n     - \`amount\`: ä¿éšªé‡‘é¡ã€‚\n     - \`deductible\`: è‡ªè² é¡ï¼Œè‹¥ç„¡å‰‡å¡« \"ç„¡\"ã€‚\n     - \`premium\`: ä¿éšªè²»ï¼ˆæ•¸å­—ï¼‰ã€‚\n     - \`id\`: å”¯ä¸€ IDã€‚\n3. **LinkLibrary è™•ç†**ï¼šè¨­ç‚ºç©ºé™£åˆ— \`[]\`ã€‚\n4. **è¼¸å‡ºé™åˆ¶**ï¼šåªå›å‚³ JSONã€‚\n\n{\n  \"meta\": { \"quoteNumber\": \"String\", \"date\": \"String\" },\n  \"client\": {\n    \"name\": \"String\", \"id\": \"String\", \"dob\": \"String\", \"phone\": \"String\",\n    \"address\": \"String\", \"plate\": \"String\",\n    \"model\": \"String\", \"manufacturingDate\": \"\",\n    \"issueDate\": \"\", \"engineNo\": \"String\",\n    \"policyPeriod\": \"String\"\n  },\n  \"coverages\": [\n    { \"id\": Number, \"code\": \"String\", \"name\": \"String\", \"detail\": \"String\", \"amount\": \"String\", \"deductible\": \"String\", \"premium\": Number }\n  ],\n  \"linkLibrary\": []\n}`;
            const [copyState, setCopyState] = useState('è¤‡è£½æŒ‡ä»¤');
            const handleCopy = () => {
                navigator.clipboard.writeText(promptText).then(() => {
                    setCopyState('å·²è¤‡è£½ï¼');
                    setTimeout(() => setCopyState('è¤‡è£½æŒ‡ä»¤'), 2000);
                });
            };
            return (
                <div className="fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-[100] p-4">
                    <div className="bg-white rounded-lg shadow-xl max-w-2xl w-full flex flex-col max-h-[90vh]">
                        <div className="p-4 border-b flex justify-between items-center bg-gray-50 rounded-t-lg">
                            <h3 className="text-xl font-bold text-gray-800"><i className="fas fa-robot text-blue-600 mr-2"></i>ç”Ÿæˆ AI è½‰æ›æŒ‡ä»¤</h3>
                            <button onClick={onClose} className="text-gray-500 hover:text-gray-700"><i className="fas fa-times text-xl"></i></button>
                        </div>
                        <div className="p-6 overflow-y-auto flex-1"><textarea readOnly className="w-full h-64 p-4 bg-gray-800 text-green-400 font-mono text-sm rounded border border-gray-700" value={promptText}></textarea></div>
                        <div className="p-4 border-t bg-gray-50 rounded-b-lg flex justify-end gap-3">
                            <button onClick={onClose} className="px-4 py-2 text-gray-600 hover:bg-gray-200 rounded">é—œé–‰</button>
                            <button onClick={handleCopy} className={`px-4 py-2 text-white rounded shadow ${copyState === 'å·²è¤‡è£½ï¼' ? 'bg-green-600' : 'bg-blue-600'}`}>{copyState}</button>
                        </div>
                    </div>
                </div>
            );
        };

        const LinkManagerView = ({ data, isEditingLinks, setIsEditingLinks, setCurrentView, handleLibraryChange, addLibraryRow, removeLibraryRow, saveAsHtml }) => {
            return (
                <div className="max-w-7xl mx-auto bg-white min-h-screen p-8">
                    <div className="flex justify-between items-center mb-6 border-b pb-4">
                        <h2 className="text-2xl font-bold text-blue-700"><i className="fas fa-database mr-2"></i>é€£çµè³‡æ–™åº«ç®¡ç†</h2>
                        <div className="flex gap-2">
                            <button onClick={() => setIsEditingLinks(!isEditingLinks)} className={`px-4 py-2 rounded font-medium ${isEditingLinks ? 'bg-green-600 text-white' : 'bg-yellow-500 text-black'}`}>{isEditingLinks ? "å®Œæˆä¸¦å„²å­˜" : "ä¿®æ”¹è¨­å®š"}</button>
                            <button onClick={saveAsHtml} className="px-4 py-2 bg-indigo-600 text-white rounded font-medium shadow"><i className="fas fa-file-download"></i> å¦å­˜æ–°æª”</button>
                            <button onClick={() => setCurrentView('presentation')} className="px-4 py-2 bg-gray-500 text-white rounded"><i className="fas fa-arrow-left"></i> è¿”å›</button>
                        </div>
                    </div>
                    <div className="overflow-x-auto shadow rounded-lg border">
                        <table className="w-full text-left border-collapse">
                            <thead className="bg-gray-100 text-gray-700">
                                <tr>
                                    <th className="p-4 w-20 bg-yellow-100">ä»£è™Ÿ</th>
                                    <th className="p-4 w-80">éšªç¨®åç¨± (åŒ¹é…é—œéµå­—)</th>
                                    <th className="p-4">é€£çµè¨­å®š</th>
                                    {isEditingLinks && <th className="p-4">åˆªé™¤</th>}
                                </tr>
                            </thead>
                            <tbody>
                                {data.linkLibrary.map((lib, index) => (
                                    <tr key={lib.id} className="border-t hover:bg-gray-50">
                                        <td className="p-4 align-top bg-yellow-50 font-bold text-center">
                                            {isEditingLinks ? <input className="w-full border-2 border-yellow-300 rounded p-1 text-center" value={lib.code || ''} onChange={(e) => handleLibraryChange(index, 'code', e.target.value)} maxLength={3} /> : lib.code}
                                        </td>
                                        <td className="p-4 align-top">
                                            {isEditingLinks ? <textarea className="w-full border rounded p-2" rows={3} value={lib.keyword} onChange={(e) => handleLibraryChange(index, 'keyword', e.target.value)} /> : lib.keyword}
                                        </td>
                                        <td className="p-4 align-top">
                                            <div className="grid grid-cols-1 md:grid-cols-2 gap-2">
                                                {[1, 2, 3, 4].map(i => (
                                                    <div key={i} className="p-2 bg-gray-50 border rounded">
                                                        <div className="text-xs text-gray-500 font-bold">é€£çµ {i}</div>
                                                        {isEditingLinks ? (
                                                            <>
                                                                <input className="w-full border p-1 text-sm mb-1" placeholder="åç¨±" value={lib[`link${i}`]?.name || ''} onChange={(e) => handleLibraryChange(index, `link${i}`, e.target.value, 'name')} />
                                                                <input className="w-full border p-1 text-sm font-mono" placeholder="ç¶²å€" value={lib[`link${i}`]?.url || ''} onChange={(e) => handleLibraryChange(index, `link${i}`, e.target.value, 'url')} />
                                                            </>
                                                        ) : (lib[`link${i}`]?.name ? <a href={lib[`link${i}`].url} target="_blank" className="text-blue-600 underline text-sm">{lib[`link${i}`].name}</a> : <span className="text-gray-300 text-sm">-</span>)}
                                                    </div>
                                                ))}
                                            </div>
                                        </td>
                                        {isEditingLinks && <td className="p-4 text-center"><button onClick={() => removeLibraryRow(index)} className="text-red-500"><i className="fas fa-trash-alt"></i></button></td>}
                                    </tr>
                                ))}
                            </tbody>
                        </table>
                    </div>
                    {isEditingLinks && <button onClick={addLibraryRow} className="mt-4 px-4 py-2 bg-green-600 text-white rounded shadow"><i className="fas fa-plus"></i> æ–°å¢è¦å‰‡</button>}
                </div>
            );
        };

        const PresentationView = ({ data, currentView, setCurrentView, handleClientChange, handleCoverageChange, addCoverageRow, removeCoverageRow, findMatchingLinks, calculatedTotal, importData, reloadInitialData, saveAsHtml, fileInputRef, setShowPromptModal }) => {
            const [mobilePrintMode, setMobilePrintMode] = useState(true);
            const [isAccordionOpen, setIsAccordionOpen] = useState(false);
            const [clickHistory, setClickHistory] = useState([]);

            const handleToggleMode = () => {
                if (!mobilePrintMode) { setMobilePrintMode(true); return; }
                const now = Date.now();
                const newHistory = [...clickHistory, now].filter(time => now - time <= 2000);
                if (newHistory.length >= 4) { setMobilePrintMode(false); setClickHistory([]); } else { setClickHistory(newHistory); }
            };

            const containerClass = mobilePrintMode ? "mobile-print-mode" : "max-w-5xl mx-auto mt-8 bg-white paper-shadow rounded-lg overflow-hidden mb-10 print:shadow-none print:w-full";
            const gridClass = mobilePrintMode ? "grid grid-cols-1 gap-4 mb-6" : "grid grid-cols-1 md:grid-cols-2 gap-6 mb-8";
            const textSizeClass = mobilePrintMode ? "text-base" : "text-sm";
            const headerTextSize = mobilePrintMode ? "text-lg font-bold" : "font-bold text-blue-800 mb-3 border-b border-blue-200 pb-2";

            const pageTitle = useMemo(() => data.client.plate ? `${data.client.plate}è»Šéšªå…§å®¹è¼”åŠ©èªªæ˜` : "è»Šéšªå…§å®¹è¼”åŠ©èªªæ˜", [data.client.plate]);
            const headerHref = useMemo(() => {
                const item = data.linkLibrary.find(lib => lib.keyword && lib.keyword.trim() === "è»Šéšªå ±åƒ¹å–®å…§å®¹");
                return item ? (item.link1?.url || item.link2?.url || item.link3?.url || item.link4?.url) : null;
            }, [data.linkLibrary]);
            const paymentHref = useMemo(() => {
                const item = data.linkLibrary.find(lib => lib.keyword && lib.keyword.trim() === "ä¸Šç¶²ç¹³è²»");
                return item ? (item.link1?.url || item.link2?.url || item.link3?.url || item.link4?.url) : null;
            }, [data.linkLibrary]);

            return (
                <div className="pb-20">
                    <div className="bg-gray-800 text-white p-3 shadow-md no-print sticky top-0 z-50">
                        <div className="max-w-6xl mx-auto flex flex-wrap justify-between items-center gap-4">
                            <h2 className="text-lg font-bold flex items-center gap-2"><i className="fas fa-car-crash text-green-400"></i>è»Šéšªå…§å®¹è¼”åŠ©</h2>
                            <div className="flex gap-2 flex-wrap text-sm">
                                <a href={paymentHref || "#"} target="_blank" className="px-3 py-2 bg-green-600 hover:bg-green-700 text-white rounded font-medium transition flex items-center gap-2"><i className="fas fa-credit-card"></i> ä¸Šç¶²ç¹³è²»</a>
                                <button onClick={handleToggleMode} className={`px-3 py-2 rounded font-medium transition flex items-center gap-2 ${mobilePrintMode ? 'bg-pink-600 text-white' : 'bg-gray-600 hover:bg-gray-700'}`}><i className="fas fa-mobile-alt"></i> {mobilePrintMode ? "é€€å‡ºæ‰‹æ©Ÿåˆ—å°" : "åˆ‡æ›æ‰‹æ©Ÿåˆ—å°æ ¼å¼"}</button>
                                {!mobilePrintMode && (
                                    <>
                                        <button onClick={() => setCurrentView(currentView === 'edit_data' ? 'presentation' : 'edit_data')} className={`px-3 py-2 rounded font-medium transition flex items-center gap-2 ${currentView === 'edit_data' ? 'bg-yellow-500 text-black' : 'bg-gray-600 hover:bg-gray-700'}`}><i className={`fas ${currentView === 'edit_data' ? 'fa-check' : 'fa-pen'}`}></i>{currentView === 'edit_data' ? "å®Œæˆ" : "ç·¨è¼¯"}</button>
                                        <button onClick={() => setCurrentView('manage_links')} className="px-3 py-2 bg-purple-600 hover:bg-purple-700 rounded font-medium transition flex items-center gap-2"><i className="fas fa-link"></i> è³‡æ–™åº«</button>
                                        <button onClick={saveAsHtml} className="px-3 py-2 bg-indigo-600 hover:bg-indigo-700 rounded font-medium transition flex items-center gap-2"><i className="fas fa-file-download"></i> å­˜æª”</button>
                                        <button onClick={() => setShowPromptModal(true)} className="px-3 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded font-medium transition flex items-center gap-2 border border-blue-400"><i className="fas fa-robot"></i> ç”Ÿæˆ AI æŒ‡ä»¤</button>
                                        <label className="px-3 py-2 bg-green-600 hover:bg-green-700 rounded font-medium cursor-pointer transition flex items-center gap-2"><i className="fas fa-file-import"></i> åŒ¯å…¥<input type="file" accept=".json" ref={fileInputRef} onChange={importData} className="hidden" /></label>
                                        <button onClick={reloadInitialData} className="px-3 py-2 bg-red-500 hover:bg-red-600 text-white rounded font-medium transition flex items-center gap-2"><i className="fas fa-undo"></i> é‚„åŸ</button>
                                    </>
                                )}
                                <button onClick={() => window.print()} className="px-3 py-2 bg-gray-200 text-gray-800 hover:bg-gray-300 rounded font-medium transition flex items-center gap-2"><i className="fas fa-print"></i> åˆ—å°</button>
                            </div>
                        </div>
                    </div>

                    <div className={containerClass}>
                        <div className="bg-blue-700 p-6 text-white flex justify-between items-center print:bg-blue-700 print:text-white shadow-inner">
                            <div><h1 className="text-3xl font-bold tracking-wider">{pageTitle}</h1></div>
                            <div className="text-right text-sm">
                                <div className="flex items-center justify-end gap-2 mt-1">
                                    {headerHref ? <a href={headerHref} target="_blank" className="hover:underline text-white flex items-center gap-1 bg-white/20 px-2 py-1 rounded"><span>è»Šéšªå ±åƒ¹å–®å…§å®¹</span><i className="fas fa-external-link-alt text-[10px]"></i></a> : <span>è»Šéšªå ±åƒ¹å–®å…§å®¹</span>}
                                </div>
                            </div>
                        </div>

                        <div className="p-8 print:p-6">
                            <div className={gridClass}>
                                <div className="bg-white p-5 rounded-xl border-l-8 border-blue-600 print:bg-blue-50 print:border-blue-500 page-break">
                                    <h3 className={headerTextSize}>è¢«ä¿éšªäººè³‡è¨Š</h3>
                                    <div className={`space-y-3 ${textSizeClass} text-gray-800`}>
                                        <div className="flex items-center"><span className="w-20 text-gray-500 font-medium">å§“åï¼š</span>{currentView === 'edit_data' ? <input className="border rounded px-2 w-full" value={data.client.name} onChange={(e) => handleClientChange('name', e.target.value)} /> : <span className="font-bold text-blue-900">{data.client.name}</span>}</div>
                                        <div className="flex items-center"><span className="w-20 text-gray-500 font-medium">èº«åˆ†è­‰è™Ÿï¼š</span>{currentView === 'edit_data' ? <input className="border rounded px-2 w-full" value={data.client.id} onChange={(e) => handleClientChange('id', e.target.value)} /> : <span>{data.client.id}</span>}</div>
                                        <div className="flex items-center"><span className="w-20 text-gray-500 font-medium">å‡ºç”Ÿæ—¥æœŸï¼š</span>{currentView === 'edit_data' ? <input className="border rounded px-2 w-full" value={data.client.dob} onChange={(e) => handleClientChange('dob', e.target.value)} /> : <span>{data.client.dob}</span>}</div>
                                        <div className="flex items-center"><span className="w-20 text-gray-500 font-medium">ä¿éšªæœŸé–“ï¼š</span>{currentView === 'edit_data' ? <input className="border rounded px-2 w-full" value={data.client.policyPeriod} onChange={(e) => handleClientChange('policyPeriod', e.target.value)} /> : <span className="text-sm bg-blue-50 text-blue-800 px-2 py-1 rounded">{data.client.policyPeriod}</span>}</div>
                                    </div>
                                </div>
                                <div className="bg-white p-5 rounded-xl border-l-8 border-indigo-600 print:bg-blue-50 print:border-blue-500 page-break">
                                    <h3 className={headerTextSize}>æŠ•ä¿è»Šè¼›æ˜ç´°</h3>
                                    <div className={`space-y-3 ${textSizeClass} text-gray-800`}>
                                        <div className="flex items-center"><span className="w-20 text-gray-500 font-medium">è»Šç‰Œè™Ÿç¢¼ï¼š</span>{currentView === 'edit_data' ? <input className="border rounded px-2 w-full" value={data.client.plate} onChange={(e) => handleClientChange('plate', e.target.value)} /> : <span className="font-bold text-lg text-indigo-900">{data.client.plate}</span>}</div>
                                        <div className="flex items-center"><span className="w-20 text-gray-500 font-medium">è»Šå‹ï¼š</span>{currentView === 'edit_data' ? <input className="border rounded px-2 w-full" value={data.client.model} onChange={(e) => handleClientChange('model', e.target.value)} /> : <span>{data.client.model}</span>}</div>
                                        <div className="flex items-center"><span className="w-20 text-gray-500 font-medium">å‡ºå» å¹´æœˆï¼š</span><span className="text-white">{data.client.manufacturingDate}</span></div>
                                        <div className="flex items-center"><span className="w-20 text-gray-500 font-medium">ç™¼ç…§æ—¥æœŸï¼š</span><span className="text-white">{data.client.issueDate}</span></div>
                                        <div className="flex items-center"><span className="w-20 text-gray-500 font-medium">å¼•æ“è™Ÿç¢¼ï¼š</span>{currentView === 'edit_data' ? <input className="border rounded px-2 w-full" value={data.client.engineNo} onChange={(e) => handleClientChange('engineNo', e.target.value)} /> : <span className="font-mono">{data.client.engineNo}</span>}</div>
                                    </div>
                                </div>
                            </div>

                            <div className="mb-8 bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden">
                                <div className="bg-green-600 text-white p-3 flex justify-between items-center print:bg-green-600 print:text-white">
                                    <h3 className="text-lg font-bold pl-2 flex items-center gap-2">ğŸ›¡ï¸ æ‰¿ä¿å…§å®¹æ˜ç´°</h3>
                                    {currentView === 'edit_data' && <button onClick={addCoverageRow} className="text-sm bg-white text-green-700 px-3 py-1 rounded hover:bg-gray-100"><i className="fas fa-plus"></i> æ–°å¢éšªç¨®</button>}
                                </div>
                                <div className="overflow-x-auto">
                                    <table className="w-full text-left border-collapse table-fixed">
                                        <thead>
                                            <tr className="bg-green-50 text-green-900 uppercase text-xs font-black leading-normal print:bg-green-100 print:text-green-900">
                                                <th className={`py-3 px-2 w-16 text-center border-b ${mobilePrintMode ? 'hidden' : ''}`}>ä»£è™Ÿ</th>
                                                <th className="py-3 px-3 w-40 border-b">éšªç¨®åç¨±</th>
                                                <th className={`py-3 px-4 w-44 border-b ${mobilePrintMode ? 'hidden' : ''}`}>çµ¦ä»˜é …ç›®/å‚™è¨»</th>
                                                <th className="py-3 px-3 w-36 text-center border-b">ä¿éšªé‡‘é¡</th>
                                                <th className={`py-3 px-2 w-20 text-center border-b ${mobilePrintMode ? 'hidden' : ''}`}>è‡ªè² é¡</th>
                                                <th className={`py-3 px-4 w-28 text-right border-b ${mobilePrintMode ? 'hidden' : ''}`}>ä¿éšªè²»(å…ƒ)</th>
                                                {currentView === 'edit_data' && <th className="py-3 px-2 w-10 text-center no-print border-b"></th>}
                                            </tr>
                                        </thead>
                                        <tbody className={`text-gray-700 ${textSizeClass}`}>
                                            {data.coverages.map((item, index) => {
                                                const matchedLinks = findMatchingLinks(item);
                                                const linksToRender = matchedLinks ? [matchedLinks.link1, matchedLinks.link2, matchedLinks.link3, matchedLinks.link4] : [];
                                                return (
                                                    <tr key={item.id} className="border-b border-gray-100 hover:bg-green-50/30 align-top">
                                                        <td className={`py-4 px-2 text-center font-bold text-green-800 break-all ${mobilePrintMode ? 'hidden' : ''}`}>
                                                            {currentView === 'edit_data' ? <input className="w-full border rounded text-center p-1" value={item.code} onChange={(e) => handleCoverageChange(index, 'code', e.target.value)} /> : item.code}
                                                        </td>
                                                        <td className="py-4 px-3 font-medium">
                                                            {currentView === 'edit_data' ? <textarea className="w-full border rounded p-1 h-auto" rows="2" value={item.name} onChange={(e) => handleCoverageChange(index, 'name', e.target.value)} /> : (
                                                                <div className="flex flex-col whitespace-normal break-words">
                                                                    <div className="flex items-center flex-wrap"><span className="text-gray-900">{item.name}</span></div>
                                                                    {matchedLinks && (
                                                                        <div className="link-wrapper">
                                                                            {linksToRender.map((link, idx) => (
                                                                                link?.url && <a key={idx} href={link.url} target="_blank" className="coverage-link"><i className="fas fa-external-link-alt mr-1"></i>{link.name || `é€£çµ${idx+1}`}</a>
                                                                            ))}
                                                                        </div>
                                                                    )}
                                                                </div>
                                                            )}
                                                        </td>
                                                        <td className={`py-4 px-4 text-black font-jhenghei text-sm leading-relaxed ${mobilePrintMode ? 'hidden' : ''}`}>
                                                            {currentView === 'edit_data' ? <textarea className="w-full border rounded text-sm p-1" value={item.detail} onChange={(e) => handleCoverageChange(index, 'detail', e.target.value)} /> : item.detail}
                                                        </td>
                                                        <td className="py-4 px-3 text-center text-black font-jhenghei text-[13px]">
                                                            {currentView === 'edit_data' ? <input className="w-full border rounded text-center" value={item.amount} onChange={(e) => handleCoverageChange(index, 'amount', e.target.value)} /> : item.amount}
                                                        </td>
                                                        <td className={`py-4 px-2 text-center text-xs ${mobilePrintMode ? 'hidden' : ''}`}>
                                                            {currentView === 'edit_data' ? <input className="w-full border rounded text-center" value={item.deductible} onChange={(e) => handleCoverageChange(index, 'deductible', e.target.value)} /> : item.deductible}
                                                        </td>
                                                        <td className={`py-4 px-4 text-right font-bold text-gray-900 whitespace-nowrap ${mobilePrintMode ? 'hidden' : ''}`}>
                                                            {currentView === 'edit_data' ? <input type="number" className="w-full border rounded text-right p-1" value={item.premium} onChange={(e) => handleCoverageChange(index, 'premium', e.target.value)} /> : (item.premium ? Number(item.premium).toLocaleString() : '0')}
                                                        </td>
                                                        {currentView === 'edit_data' && <td className="py-4 px-2 text-center no-print"><button onClick={() => removeCoverageRow(index)} className="text-red-500"><i className="fas fa-times"></i></button></td>}
                                                    </tr>
                                                );
                                            })}
                                            <tr className="bg-green-50/50 font-bold text-gray-800 print:bg-green-50">
                                                <td colSpan={mobilePrintMode ? 1 : 5} className="py-6 px-4 text-right text-lg">ğŸ’° ç¸½ä¿éšªè²» (æ–°å°å¹£)</td>
                                                <td colSpan={1} className="py-6 px-4 text-right text-2xl text-red-600 font-black">${calculatedTotal.toLocaleString()}</td>
                                                {currentView === 'edit_data' && <td className="no-print"></td>}
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            <div className={gridClass}>
                                <div className="page-break bg-red-50 p-5 rounded-xl border border-red-100 shadow-sm">
                                    <h4 className="font-bold caution mb-2 text-xl flex items-center gap-2">æ³¨æ„äº‹é …</h4>
                                    <ul className="list-disc list-inside text-red-600 space-y-2 font-medium">
                                        <li>æœ¬è³‡æ–™åƒ…ç‚ºæ‚¨æä¾›è»Šéšªè¼”åŠ©èªªæ˜åŠå¯èƒ½éœ€è¦çš„æœå‹™ç›¸é—œé€£çµã€‚</li>
                                        <li>è©³ç´°æ‰¿ä¿å…§å®¹ä»¥æ­£å¼ä¿å–®æ¢æ¬¾ç‚ºæº–ã€‚</li>
                                    </ul>

                                    <div onClick={() => setIsAccordionOpen(!isAccordionOpen)} className="cursor-pointer bg-white p-4 rounded-xl shadow-sm hover:bg-blue-50 transition-all flex justify-between items-center mt-6 zoom-item">
                                        <h4 className="m-0 font-bold text-xl flex items-center gap-1">
                                            <span className="text-green-600">è»Šéšªæœå‹™åŠè¯çµ¡å°ˆç·š</span>
                                            <span className="text-red-600 font-black">({isAccordionOpen ? 'å±•é–‹' : 'å±•é–‹'})</span>
                                        </h4>
                                        <i className={`fas fa-chevron-${isAccordionOpen ? 'up' : 'down'} text-blue-600`}></i>
                                    </div>

                                    <div className={`accordion-content ${isAccordionOpen ? 'open' : ''} mt-4`}>
                                        <div className="space-y-4">
                                            <div className="grid grid-cols-1 gap-3">
                                                <a href="https://drive.google.com/file/d/1lAIChS7GiMkUkgB71JMexCVHpvHcGtDi/view?usp=drive_link" target="_blank" className="flex items-center p-3 bg-green-50 border border-green-200 rounded-lg text-green-700 font-bold hover:bg-green-100 transition shadow-sm zoom-item">
                                                    <span className="mr-3 text-xl">ğŸ“</span> è»Šç¦ç¾å ´è™•ç†åŸå‰‡
                                                </a>
                                                <a href="https://notebooklm.google.com/notebook/2357da7b-cc3e-4bb1-b5af-88ba09d62456" target="_blank" className="flex items-center p-3 bg-white border border-gray-200 rounded-lg text-gray-700 shadow-sm hover:bg-gray-50 transition zoom-item">
                                                    <span className="mr-3 text-xl">ğŸ¤–</span> äº¤é€šæ³•è¦åŠäº‹æ•…è™•ç† AIï¼š<span className="text-blue-600 font-bold underline ml-1">é»æ­¤è«®è©¢</span>
                                                </a>
                                                <a href="https://www.nanshangeneral.com.tw/claims-personal" target="_blank" className="flex items-center p-3 bg-yellow-50 border border-yellow-200 rounded-lg text-yellow-700 font-bold hover:bg-yellow-100 transition shadow-sm zoom-item">
                                                    <span className="mr-3 text-xl">ğŸ“</span> æ‹–åŠé›»è©±åŠç†è³ ç›¸é—œ
                                                </a>
                                                <a href="https://www.nanshangeneral.com.tw/qa-list?parent=policyclaims&type=automobilemotorcycleinsurance" target="_blank" className="flex items-center p-3 bg-purple-50 border border-purple-200 rounded-lg text-purple-700 font-bold hover:bg-purple-100 transition shadow-sm zoom-item">
                                                    <span className="mr-3 text-xl">ğŸ’¡</span> ç†è³ Q&A
                                                </a>
                                            </div>

                                            <h4 className="font-bold text-green-800 mt-6 mb-3 flex items-center text-lg">
                                                <i className="fas fa-user-tie mr-2"></i>å°ˆå±¬æœå‹™äººå“¡
                                            </h4>
                                            <div className="space-y-3">
                                                <div className="flex items-center p-3 bg-white border border-gray-200 rounded-lg text-gray-800 font-bold shadow-sm zoom-item">
                                                    <span className="mr-3 text-xl">ğŸ‘¤</span> å—å±±äººå£½ æä»²å¹³ å€ç¶“ç†
                                                </div>
                                                <div className="flex items-center p-3 bg-blue-50 border border-blue-200 rounded-lg text-blue-700 font-bold shadow-sm zoom-item">
                                                    <span className="mr-3 text-xl">ğŸ›¡ï¸</span> ç†è³ å”èª¿ï¼Œè»Šç¦èª¿è§£ï¼Œè‚‡è²¬åˆ†æ
                                                </div>
                                                <a href="tel:0932218851" className="flex items-center p-3 bg-green-50 border border-green-200 rounded-lg text-green-700 font-bold hover:bg-green-100 transition shadow-sm zoom-item">
                                                    <span className="mr-3 text-xl">ğŸ“</span> 0932-218851
                                                </a>
                                                <a href="https://line.me/ti/p/~0932218851" target="_blank" className="flex items-center p-3 bg-white border border-gray-200 rounded-lg text-gray-700 font-bold hover:bg-green-50 transition shadow-sm zoom-item">
                                                    <span className="mr-3 text-xl"><i className="fab fa-line text-green-500"></i></span> LINE ID: 0932218851
                                                </a>
                                                <a href="mailto:abc0480@gmail.com" className="flex items-center p-3 bg-white border border-gray-200 rounded-lg text-gray-700 font-bold hover:bg-blue-50 transition shadow-sm zoom-item">
                                                    <span className="mr-3 text-xl">âœ‰ï¸</span> abc0480@gmail.com
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const App = () => {
            const [data, setData] = useState(INITIAL_DATA);
            const [currentView, setCurrentView] = useState('presentation');
            const [isEditingLinks, setIsEditingLinks] = useState(false);
            const [showPromptModal, setShowPromptModal] = useState(false);
            const fileInputRef = useRef(null);

            const calculatedTotal = useMemo(() => data.coverages.reduce((sum, item) => sum + Number(item.premium || 0), 0), [data.coverages]);

            const handleClientChange = useCallback((field, value) => setData(prev => ({ ...prev, client: { ...prev.client, [field]: value } })), []);
            const handleCoverageChange = useCallback((index, field, value) => {
                setData(prev => {
                    const newCoverages = [...prev.coverages];
                    newCoverages[index] = { ...newCoverages[index], [field]: value };
                    return { ...prev, coverages: newCoverages };
                });
            }, []);
            const addCoverageRow = useCallback(() => setData(prev => ({ ...prev, coverages: [...prev.coverages, { id: Date.now(), code: "", name: "", detail: "", amount: "", deductible: "", premium: 0 }] })), []);
            const removeCoverageRow = useCallback((index) => setData(prev => ({ ...prev, coverages: prev.coverages.filter((_, i) => i !== index) })), []);

            const handleLibraryChange = useCallback((index, field, value, subField = null) => {
                setData(prev => {
                    const newLibrary = [...prev.linkLibrary];
                    newLibrary[index] = { ...newLibrary[index] };
                    if (subField) newLibrary[index][field] = { ...newLibrary[index][field], [subField]: value };
                    else newLibrary[index][field] = value;
                    return { ...prev, linkLibrary: newLibrary };
                });
            }, []);
            const addLibraryRow = useCallback(() => setData(prev => ({ ...prev, linkLibrary: [...prev.linkLibrary, { id: Date.now(), code: "", keyword: "", link1: { name: "", url: "" }, link2: { name: "", url: "" }, link3: { name: "", url: "" }, link4: { name: "", url: "" } }] })), []);
            const removeLibraryRow = useCallback((index) => setData(prev => ({ ...prev, linkLibrary: prev.linkLibrary.filter((_, i) => i !== index) })), []);

            const findMatchingLinks = (coverageItem) => {
                if (!coverageItem.name) return null;
                return data.linkLibrary.find(lib => lib.keyword && lib.keyword.trim() === coverageItem.name.trim());
            };

            const saveAsHtml = () => {
                try {
                    const clone = document.documentElement.cloneNode(true);
                    const cloneRoot = clone.querySelector('#root');
                    if(cloneRoot) cloneRoot.innerHTML = '';
                    let dataScript = clone.querySelector("#saved-data");
                    if(!dataScript) { dataScript = document.createElement('script'); dataScript.id = 'saved-data'; dataScript.type = 'application/json'; clone.querySelector('body').appendChild(dataScript); }
                    dataScript.textContent = JSON.stringify(data, null, 2);
                    const blob = new Blob([clone.outerHTML], { type: "text/html" });
                    const url = URL.createObjectURL(blob);
                    const link = document.createElement('a');
                    link.href = url;
                    const period = data.client.policyPeriod || "";
                    const dateParts = period.match(/\d+/g);
                    const datePrefix = dateParts ? dateParts.slice(0,3).join('') : "";
                    const name = data.client.name || "";
                    const plate = data.client.plate || "";
                    const fileName = `${datePrefix}${name}(${plate})è»Šéšªè¼”åŠ©èªªæ˜.html`;
                    link.download = fileName;
                    document.body.appendChild(link); link.click(); document.body.removeChild(link);
                } catch (e) { console.error(e); }
            };

            const importData = (event) => {
                const file = event.target.files[0];
                if (!file) return;
                const reader = new FileReader();
                reader.onload = (e) => {
                    try {
                        const importedData = JSON.parse(e.target.result);
                        if (!importedData.client || !importedData.coverages) throw new Error("Format error");
                        if (!importedData.linkLibrary || importedData.linkLibrary.length === 0) importedData.linkLibrary = data.linkLibrary;
                        setData(importedData);
                    } catch (error) { console.error("è³‡æ–™æ ¼å¼éŒ¯èª¤ã€‚"); }
                };
                reader.readAsText(file);
                event.target.value = '';
            };

            const reloadInitialData = () => { if(confirm('ç¢ºå®šè¦é‚„åŸåˆ°é è¨­å€¼å—ï¼Ÿ')) setData(FACTORY_DEFAULTS); };

            return (
                <div className="min-h-screen bg-gray-100">
                    {currentView === 'manage_links' ? 
                        <LinkManagerView data={data} isEditingLinks={isEditingLinks} setIsEditingLinks={setIsEditingLinks} setCurrentView={setCurrentView} handleLibraryChange={handleLibraryChange} addLibraryRow={addLibraryRow} removeLibraryRow={removeLibraryRow} saveAsHtml={saveAsHtml} /> : 
                        <PresentationView data={data} currentView={currentView} setCurrentView={setCurrentView} handleClientChange={handleClientChange} handleCoverageChange={handleCoverageChange} addCoverageRow={addCoverageRow} removeCoverageRow={removeCoverageRow} findMatchingLinks={findMatchingLinks} calculatedTotal={calculatedTotal} importData={importData} reloadInitialData={reloadInitialData} saveAsHtml={saveAsHtml} fileInputRef={fileInputRef} setShowPromptModal={setShowPromptModal} />
                    }
                    {showPromptModal && <PromptModal onClose={() => setShowPromptModal(false)} />}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
    <div id="root"></div>
</body></html>