
                <!DOCTYPE html>
                <html lang="zh-TW">
                <head>
                    <meta charset="UTF-8">
                    <title>理賠彙總報表</title>
                    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
                    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
                    <style>
        :root { 
            --primary-color: #0d6efd; 
            --bg-color: #f4f7f9; 
            --ai-purple: #6f42c1; 
            --ai-teal: #17a2b8; 
            --case-bg: #fffceb; 
            --hover-green: #198754; 
            --dark-green: #1b5e20; 
            --coffee-color: #8B4513;
            --pale-green: #d1e7dd; 
            --pale-red: #f8d7da;
            --logic-orange: #fd7e14;
            --gray-btn: #e9ecef;
            --deep-gray: #6c757d;
            --hover-red: #dc3545; 
        }
        
        body { 
            background-color: var(--bg-color); 
            font-family: "Microsoft JhengHei", "Heiti TC", sans-serif; 
            overflow-x: hidden; 
            color: #000;
        }

        .main-content { padding: 2rem; }
        .data-card { background: white; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); border: 1px solid #e0e0e0; overflow: hidden; margin-bottom: 2rem; }
        .ai-header { color: white; padding: 2rem; border-radius: 12px 12px 0 0; }
        .bg-analysis { background: linear-gradient(135deg, #17a2b8, #0d6efd); }
        .bg-lab { background: linear-gradient(135deg, #6f42c1, #0d6efd); }
        .bg-logic { background: linear-gradient(135deg, var(--logic-orange), #d63384); }
        
        .btn:hover, .btn-analysis:hover, .btn-case:hover, .btn-view-case:hover, .btn-custom-pale:hover, .btn-warning:hover {
            background-color: var(--hover-red) !important;
            color: #ffffff !important;
            border-color: var(--hover-red) !important;
            box-shadow: 0 4px 8px rgba(220, 53, 69, 0.3);
            transition: all 0.2s ease-in-out;
        }

        .btn-view-case {
            background-color: var(--pale-green) !important;
            color: #000 !important;
            border: 1px solid #badbcc !important;
            font-weight: bold;
        }

        .upload-zone { border: 2px dashed #dee2e6; border-radius: 12px; padding: 1.5rem; text-align: center; transition: all 0.3s; background: #fff; cursor: pointer; }
        .upload-zone:hover { border-color: var(--ai-purple); background: #f8f0ff; }
        
        .table td, .table th { 
            white-space: normal !important; 
            word-break: break-all !important; 
            overflow-wrap: break-word !important;
            vertical-align: top;
            padding: 12px 8px !important;
        }

        .duplicate-highlight {
            background-color: var(--pale-red) !important;
            color: #842029 !important;
            border-radius: 4px;
        }

        .kw-list-tag {
            font-size: 0.75rem;
            padding: 2px 8px;
            background: #f1f3f5;
            border: 1px solid #dee2e6;
            border-radius: 50px;
            margin-right: 4px;
            margin-bottom: 4px;
            display: inline-block;
            color: #495057;
        }

        .kw-tag { 
            font-size: 0.7rem; padding: 2px 8px; border-radius: 4px; margin-right: 4px; display: inline-block; margin-bottom: 4px; border: 1px solid transparent; font-weight: bold;
        }
        .kw-hit { background-color: var(--pale-green) !important; color: #0f5132 !important; border-color: #badbcc !important; }
        .kw-miss { background-color: var(--pale-red) !important; color: #842029 !important; border-color: #f5c2c7 !important; }

        .overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.75); display: flex; align-items: center; justify-content: center; z-index: 10000; color: white; flex-direction: column; text-align: center; padding: 20px; }
        
        .info-modal { 
            position: fixed; 
            top: 50%; 
            left: 50%; 
            transform: translate(-50%, -50%); 
            background: white; 
            color: #333; 
            padding: 2.5rem; 
            border-radius: 20px; 
            box-shadow: 0 25px 80px rgba(0,0,0,0.5); 
            z-index: 12000; 
            width: 95%; 
            max-width: 900px; 
            max-height: 85vh; 
            overflow-y: auto; 
            text-align: left; 
            border-top: 10px solid var(--primary-color); 
        }
        .info-modal h5 { color: var(--primary-color); font-weight: 800; border-bottom: 2px solid #eee; padding-bottom: 12px; margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center; }
        
        .hover-tooltip {
            position: absolute;
            background: #ffffff;
            color: #333;
            border: 2px solid var(--primary-color);
            padding: 15px;
            border-radius: 12px;
            box-shadow: 0 8px 24px rgba(0,0,0,0.2);
            z-index: 20000;
            max-width: 350px;
            font-size: 0.85rem;
            pointer-events: none;
            line-height: 1.5;
        }

        .confirm-modal { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; color: #333; padding: 2rem; border-radius: 12px; box-shadow: 0 10px 40px rgba(0,0,0,0.3); z-index: 15000; width: 90%; max-width: 400px; text-align: center; }

        .btn-analysis { background-color: var(--ai-teal); color: white; border: none; font-weight: bold; }
        .btn-case { background-color: #ffc107; color: #000; border: none; font-weight: bold; font-size: 0.8rem; transition: all 0.3s; }
        
        .recognition-text, .case-body { 
            font-family: "Microsoft JhengHei", "Heiti TC", sans-serif !important; 
            color: #000 !important; 
            line-height: 1.7;
        }
        
        .case-body table { width: 100%; background: white; margin: 15px 0; border-radius: 8px; overflow: hidden; border-collapse: collapse; font-size: 0.9rem; border: 1px solid #dee2e6; }
        .case-body th, .case-body td { padding: 12px; border: 1px solid #dee2e6; text-align: left; color: #000 !important; }
        .case-body th { background: #f8f9fa; color: var(--dark-green) !important; font-weight: 700; }
        
        .info-trigger { color: #0d6efd !important; text-decoration: underline dashed; cursor: pointer; font-weight: bold; transition: all 0.2s; }
        .info-trigger:hover { color: #dc3545 !important; background-color: rgba(220, 53, 69, 0.1); border-radius: 2px; }

        .summary-wrapper { background: #fff; border: 2px solid #0d6efd; border-radius: 12px; padding: 2.5rem; margin-top: 3rem; position: relative; }
        .summary-wrapper h3 { color: var(--coffee-color) !important; font-weight: 800 !important; }

        .logic-card { border-left: 5px solid var(--logic-orange); }
        .logic-label { font-weight: bold; color: var(--logic-orange); margin-bottom: 0.5rem; display: block; font-size: 0.9rem; }
        .logic-textarea { font-family: 'Consolas', 'Monaco', monospace; font-size: 0.85rem; line-height: 1.5; background-color: #fcfcfc; }

        .reminder-box { border: 2px solid var(--logic-orange); background: #fff9f5; border-radius: 10px; padding: 1rem; margin-bottom: 1.5rem; }
        .reminder-title { color: var(--logic-orange); font-weight: 800; font-size: 0.85rem; margin-bottom: 0.5rem; display: flex; align-items: center; justify-content: space-between; }

        .knowledge-frame { border: 2px solid var(--ai-purple); background-color: #f8f0ff; border-radius: 12px; padding: 1.5rem; margin-top: 2rem; }
        .knowledge-title { color: var(--ai-purple); font-weight: 800; margin-bottom: 1rem; display: flex; align-items: center; }
        .conflict-warning { color: #dc3545 !important; font-weight: 900; background: #fff5f5; padding: 10px; border-radius: 6px; border: 1px solid #ffc1c1; margin-bottom: 15px; font-size: 0.9rem; }

        .ai-hint-box { background-color: #e7f3ff; border: 1px solid #b6d4fe; border-radius: 8px; padding: 12px; margin-bottom: 15px; }
        .ai-hint-title { color: #084298; font-weight: bold; font-size: 0.85rem; margin-bottom: 5px; }

        .msg-box-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.6); display: flex; align-items: center;
            justify-content: center; z-index: 20000;
        }
        .msg-box {
            background: white; padding: 2rem; border-radius: 12px;
            max-width: 400px; width: 90%; text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        .btn-copy-float { position: absolute; top: 15px; right: 15px; }
        
        /* 輔助類別 */
        .x-small { font-size: 0.8rem; }
        .btn-custom-pale { background-color: var(--pale-green); color: #0f5132; }
        .btn-no-link { background-color: #eee; color: #999; cursor: not-allowed; }
    </style><style>
.info-trigger {
    cursor: pointer;
    border-bottom: 1px dashed #000;
    position: relative;
    display: inline-block;
}
.info-box {
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 80%;
    max-width: 700px;
    background-color: white;
    border: 2px solid #0d6efd;
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    z-index: 1000;
    padding: 20px;
    border-radius: 8px;
    max-height: 90vh;
    overflow-y: auto;
}
.info-box h4 {
    color: #0d6efd;
    border-bottom: 2px solid #0d6efd;
    padding-bottom: 5px;
    margin-top: 0;
}
.overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    z-index: 999;
}
.highlight-row {
    background-color: #f8d7da;
}
</style><style>
.info-trigger {
    cursor: pointer;
    border-bottom: 1px dashed #0d6efd;
    position: relative;
    display: inline-block;
}
.info-box {
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 80%;
    max-width: 600px;
    padding: 20px;
    background-color: white;
    border: 2px solid #0d6efd;
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    z-index: 1000;
    border-radius: 8px;
}
.info-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    z-index: 999;
}
.highlight-row {
    background-color: #f8d7da;
}
</style>
                </head>
                <body class="case-body" style="padding: 2rem;">
                    <div style="color: #8B4513; font-size: 2em; font-weight: bold; text-align: center; margin-bottom: 20px;">理賠彙總分析</div>

<div style="margin: 20px 0 10px 0;"><span style="color: white; background-color: #0d6efd; padding: 4px 12px; border-radius: 4px; font-weight: bold;">假設情境 : </span></div>
<div style="background-color: #fffceb; padding: 15px; border: 1px solid #ccc; border-radius: 5px;">
被保險人因急性闌尾炎住院5天（一般病房）。本次醫療費用包含急診醫療費用6,000元、每日病房費3,500元、醫院雜項費用85,000元、手術費用15,000元（闌尾切除術）。住院前門診1次（費用800元），出院後門診2次（每次費用600元）。
</div>

<div style="margin: 20px 0 10px 0;"><span style="color: white; background-color: #0d6efd; padding: 4px 12px; border-radius: 4px; font-weight: bold;">一、理賠金額為 0 的險種</span></div>

<div style="margin-left: 10px;">
<div style="margin-bottom: 5px;">a. N20TL2 南山人壽新定期壽險 (200萬元)</div>
<div style="margin-bottom: 5px;">b. SBBR 南山人壽意外骨折及特定手術傷害醫療保險附約 (100萬元)</div>
<div style="margin-bottom: 5px;">c. MN 南山人壽意外傷害醫療保險附約 (計畫3)</div>
<div style="margin-bottom: 5px;">d. CR 南山人壽癌症醫療保險 (主約) (2單位)</div>
</div>

<div style="margin: 20px 0 10px 0;"><span style="color: white; background-color: #0d6efd; padding: 4px 12px; border-radius: 4px; font-weight: bold;">二、有理賠險種</span></div>

<div style="margin-left: 10px;">
<div style="margin-bottom: 5px;">A. 1. HPSI2 南山人壽溢同安心2手術醫療保險 (1單位)、理賠金額 20,000元</div>
<div style="margin-bottom: 5px;">B. 2. 1HS-C 南山人壽實踐幸福住院醫療健康保險附約 1HS-C型 (計畫1份)、理賠金額 106,500元</div>
<div style="margin-bottom: 5px;">C. 3. HSD-E 南山人壽超實踐幸福自負額住院醫療健康保險附約 E型 (計畫1份)、理賠金額 16,000元</div>
<div style="margin-bottom: 5px;">D. 4. HWHI 日溢美滿住院日額終身保險 (2,000元)、理賠金額 11,500元</div>
</div>

<div style="margin: 20px 0 10px 0;"><span style="color: white; background-color: #0d6efd; padding: 4px 12px; border-radius: 4px; font-weight: bold;">三、各商品理賠分析及計算式</span></div>

<div style="background-color: #d1e7dd; display: block; margin: 25px 0; font-weight: bold; padding: 8px;">A. HPSI2 南山人壽溢同安心2手術醫療保險 (1單位)</div>
<div style="margin-left: 10px;">
<div style="color: #8B4513; font-weight: bold;">理賠分析：</div>
<br>
<ul style="list-style-type: disc; padding-left: 20px;">
<li style="margin-bottom: 2rem;">本保險為定額給付型手術險，針對保單條款表列之手術項目提供定額給付。</li>
<li style="margin-bottom: 2rem;">闌尾切除術屬於條款中「常見手術項目(少年)」列表，定額給付20,000元。</li>
<li style="margin-bottom: 2rem;">本險不給付住院日額、雜費或門診費用。</li>
</ul>
<div style="color: #8B4513; font-weight: bold;">計算式：</div>
<br>
<ul style="list-style-type: disc; padding-left: 20px;">
<li style="margin-bottom: 2rem;">手術醫療保險金 (闌尾切除術)：定額給付 20,000元</li>
<li style="margin-bottom: 2rem;">總理賠金額：20,000元</li>
</ul>
</div>

<div style="background-color: #d1e7dd; display: block; margin: 25px 0; font-weight: bold; padding: 8px;">B. 1HS-C 南山人壽實踐幸福住院醫療健康保險附約 1HS-C型 (計畫1份)</div>
<div style="margin-left: 10px;">
<div style="color: #8B4513; font-weight: bold;">理賠分析：</div>
<br>
<ul style="list-style-type: disc; padding-left: 20px;">
<li style="margin-bottom: 2rem;">本險為實支實付型醫療險，計畫1份。</li>
<li style="margin-bottom: 2rem;">每日病房費用限額1,000元/日，住院5天，理賠5,000元。</li>
<li style="margin-bottom: 2rem;">醫院各項雜費及手術費用限額100,000元/次住院。實際費用總計：急診費用(最高認列5,000元) + 雜費(85,000元) + 手術費(15,000元) = 105,000元。未超過限額，理賠100,000元。</li>
<li style="margin-bottom: 2rem;">住院前後門診費用限額500元/次，共3次門診，理賠1,500元。</li>
</ul>
<div style="color: #8B4513; font-weight: bold;">計算式：</div>
<br>
<ul style="list-style-type: disc; padding-left: 20px;">
<li style="margin-bottom: 2rem;">每日病房費用保險金：1,000元 X 5天 = 5,000元</li>
<li style="margin-bottom: 2rem;">醫院各項雜費及手術費用保險金：MIN(實際費用105,000元, 限額100,000元) = 100,000元</li>
<li style="margin-bottom: 2rem;">住院前後門診保險金：500元 X 3次 = 1,500元</li>
<li style="margin-bottom: 2rem;">總理賠金額：5,000元 + 100,000元 + 1,500元 = 106,500元</li>
</ul>
</div>

<div style="background-color: #d1e7dd; display: block; margin: 25px 0; font-weight: bold; padding: 8px;">C. HSD-E 南山人壽超實踐幸福自負額住院醫療健康保險附約 E型 (計畫1份)</div>
<div style="margin-left: 10px;">
<div style="color: #8B4513; font-weight: bold;">理賠分析：</div>
<br>
<ul style="list-style-type: disc; padding-left: 20px;">
<li style="margin-bottom: 2rem;">本險為實支實付型自負額醫療險，計畫1份。</li>
<li style="margin-bottom: 2rem;">每日病房費用：每日限額3,000元，每日自負額1,000元。實際費用3,500元，理賠金額為 (3,000元 - 1,000元) X 5天。</li>
<li style="margin-bottom: 2rem;">醫院各項雜費及手術費：總費用106,000元，自負額100,000元。理賠金額為 106,000元 - 100,000元。</li>
<li style="margin-bottom: 2rem;"><b style="color: red;">理賠排除告知：</b>本附約不給付住院前後門診費用。闌尾切除術不屬於特定手術關懷保險金的給付範圍。</li>
</ul>
<div style="color: #8B4513; font-weight: bold;">計算式：</div>
<br>
<ul style="list-style-type: disc; padding-left: 20px;">
<li style="margin-bottom: 2rem;">每日病房費用保險金：(MIN(3,500元, 3,000元) - 1,000元) X 5天 = 10,000元</li>
<li style="margin-bottom: 2rem;">醫院各項雜費及手術費保險金：(6,000元 + 85,000元 + 15,000元) - 100,000元 = 6,000元</li>
<li style="margin-bottom: 2rem;">總理賠金額：10,000元 + 6,000元 = 16,000元</li>
</ul>
</div>

<div style="background-color: #d1e7dd; display: block; margin: 25px 0; font-weight: bold; padding: 8px;">D. HWHI 日溢美滿住院日額終身保險 (2,000元)</div>
<div style="margin-left: 10px;">
<div style="color: #8B4513; font-weight: bold;">理賠分析：</div>
<br>
<ul style="list-style-type: disc; padding-left: 20px;">
<li style="margin-bottom: 2rem;">本險為日額型醫療險，單位日額2,000元。</li>
<li style="margin-bottom: 2rem;">住院日額保險金：按單位日額給付，住院5天。</li>
<li style="margin-bottom: 2rem;">住院前後門診醫療保險金：按單位日額的0.25倍給付，共3次門診。</li>
<li style="margin-bottom: 2rem;"><b style="color: red;">理賠排除告知：</b>本險為日額型，不理賠實際發生的病房費差額、雜費、急診費用或手術費用。</li>
</ul>
<div style="color: #8B4513; font-weight: bold;">計算式：</div>
<br>
<ul style="list-style-type: disc; padding-left: 20px;">
<li style="margin-bottom: 2rem;">住院日額保險金：2,000元 X 5天 = 10,000元</li>
<li style="margin-bottom: 2rem;">住院前門診醫療保險金：(2,000元 X 0.25) X 1次 = 500元</li>
<li style="margin-bottom: 2rem;">住院後門診醫療保險金：(2,000元 X 0.25) X 2次 = 1,000元</li>
<li style="margin-bottom: 2rem;">總理賠金額：10,000元 + 500元 + 1,000元 = 11,500元</li>
</ul>
</div>

<div style="margin-top: 30px; padding: 15px; border: 2px solid #8B4513; background-color: #f9f9f9; text-align: center;">
<b style="font-size: 1.2em; color: #8B4513;">本次理賠總彙總金額：154,000元</b>
</div>
                    <div id="exported-overlay" style="position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.85);display:none;align-items:center;justify-content:center;z-index:99999;">
                        <div style="background:white;padding:2.5rem;border-radius:20px;max-width:900px;width:95%;max-height:85vh;overflow-y:auto;border-top:10px solid #0d6efd;position:relative;">
                             <h5 style="color:#0d6efd;font-weight:800;border-bottom:2px solid #eee;padding-bottom:12px;margin-bottom:20px;">詳情展示</h5>
                             <div id="exported-content" class="case-body"></div>
                        </div>
                    </div>
                    <script>
                        document.addEventListener('click', function(e) {
                            const t = e.target.closest('.info-trigger');
                            if(t) {
                                document.getElementById('exported-content').innerHTML = t.getAttribute('data-info');
                                document.getElementById('exported-overlay').style.display = 'flex';
                            }
                        });
                        document.addEventListener('dblclick', function() { document.getElementById('exported-overlay').style.display = 'none'; });
                    </script>
                </body>
                </html>
            